Array.prototype.find||(Array.prototype.find=function(a){for(var b,c=Object(this),d=c.length>>>0,e=arguments[1],f=0;d>f;f++)if(b=c[f],a.call(e,b,f,c))return b});var DDRAppConfig={},DD={generatedId:1,genId:function(){return this.generatedId++},extend:function(){for(var a=arguments,b={},c=0;c<a.length;c++)if(DD.isObject(a[c])){var d=a[c];for(var e in d)DD.isObject(d[e])?DD.isObject(b[e])?DD.merge(b[e],d[e]):b[e]=DD.merge({},d[e]):b[e]=d[e]}return b},merge:function(a,b){function c(a,b){if(-1!==d.indexOf(b))return b;if(d.push(b),DD.isArray(a)&&DD.isArray(b))b.forEach(function(b,d){DD.isArray(b)?a[d]=c([],b):DD.isObject(b)?a[d]=c({},b):a[d]=b});else for(var e in b)DD.isObject(b[e])?(DD.isObject(a[e])||(a[e]={}),c(a[e],b[e])):DD.isArray(b[e])?(DD.isArray(a[e])||(a[e]=[]),b[e].forEach(function(b,d){var f;f=DD.isObject(b)?c({},b):DD.isArray(b)?c([],b):b,a[e][d]=f})):a[e]=b[e];return a}var d=[];return c(a,b),a},assign:function(a,b){Object.assign?Object.assign(a,b):DD.getOwnProps(b).forEach(function(c){a[c]=b[c]})},getOwnProps:function(a){return Object.getOwnPropertyNames(a)},isFunction:function(a){return void 0!==a&&null!==a&&a.constructor===Function},isArray:function(a){return void 0!==a&&null!==a&&a.constructor===Array},isObject:function(a){return null!==a&&void 0!==a&&a.constructor===Object},isInt:function(a){return Number.isInteger(a)},isNumber:function(a){return"number"==typeof a},isBoolean:function(a){return"boolean"==typeof a},isString:function(a){return"string"==typeof a},isEmpty:function(a){if(null===a||void 0===a)return!0;var b=typeof a;if(DD.isObject(a)){var c=Object.keys(a);if(void 0!==c)return 0===c.length}else if("string"===b)return""===a;return!1},get:function(a,b,c){return c=c||document,b===!0?c.querySelectorAll(a):c.querySelector(a)},append:function(a,b){if(DD.isNode(b))a.appendChild(b);else if(DD.isString(b)){var c=DD.newEl("div");c.innerHTML=b,DD.transChildren(c,a)}},isEl:function(a){return void 0!==a&&null!==a&&a.nodeType===Node.ELEMENT_NODE},isNode:function(a){return void 0!==a&&null!==a&&(a.nodeType===Node.TEXT_NODE||a.nodeType===Node.ELEMENT_NODE||a.nodeType===Node.DOCUMENT_FRAGMENT_NODE)},cloneNode:function(a){var b;return b=a.cloneNode(!0),DD.copyProp(b,a),b},copyProp:function(a,b){var c={},d=["$model","$module","$events"];DD.getOwnProps(b).forEach(function(a){if("$"===a[0]){for(var e=!1,f=0;f<d.length;f++)if(a===d[f]){e=!0;break}e||(c[a]=b[a])}}),DD.merge(a,c),a.$module=b.$module,a.$events={},b.$model&&(a.$model={},DD.getOwnProps(b.$model).forEach(function(c){a.$model[c]=b.$model[c]})),DD.isEmpty(b.$events)||DD.getOwnProps(b.$events).forEach(function(c){var d=b.$events[c];if(d instanceof DD.Event){d.module;d.view=a,delete d.module;var e=DD.merge({},d);new DD.Event(e)}});for(var e=0;e<a.childNodes.length;e++)DD.copyProp(a.childNodes[e],b.childNodes[e])},getAttrs:function(a,b){for(var c=[],d=0;d<a.attributes.length;d++){var e=a.attributes[d];b.test(e.name)&&c.push(e)}return c},getAttrsByValue:function(a,b){for(var c=[],d=0;d<a.attributes.length;d++){var e=a.attributes[d];b.test(e.value)&&c.push(e)}return c},copyAttrs:function(a,b){for(var c=0;c<a.attributes.length;c++){var d=a.attributes[c];b.setAttribute(d.name,d.value)}},newEl:function(a,b,c){var d=document.createElement(a);return DD.isObject(b)?DD.attr(d,b):DD.isString(c)&&(d.innerHTML=c),d},replaceNode:function(a,b,c){var d=a.parentNode,e=a.nextSibling;null!==d&&(d.removeChild(a),DD.isArray(b)||(b=[b]),b.forEach(function(b){void 0===e||null===e?d.appendChild(b):d.insertBefore(b,e),c!==!1&&(c=!0),c&&a.$isView&&DD.copyProp(b,a)}))},insertAfter:function(a,b,c){var d=this,e=null;void 0===b||null===b?e=c.firstChild:(c=b.parentNode,e=b.nextSibling),DD.isNode(c)&&(null===e?DD.isArray(a)?a.forEach(function(a){d.isEl(a)&&c.appendChild(a)}):c.appendChild(a):DD.isArray(a)?a.forEach(function(a){d.isEl(a)&&c.insertBefore(a,e)}):c.insertBefore(a,e))},empty:function(a){for(var b=a.childNodes,c=b.length-1;c>=0;c--)a.removeChild(b[c])},remove:function(a){null!==a.parentNode&&a.parentNode.removeChild(a)},copyChildren:function(a){for(var b=a.childNodes,c=[],d=b.length-1;d>=0;d--)c.push(b[d]);return c},transChildren:function(a,b){for(var c=document.createDocumentFragment();a.childNodes.length>0;)c.appendChild(a.childNodes[0]);b.appendChild(c)},attr:function(a,b,c){if(void 0===c||null===c){if(DD.isObject(b))DD.getOwnProps(b).forEach(function(c){"value"===c?a[c]=b[c]:a.setAttribute(c,b[c])});else if(DD.isString(b))return"value"===b?b.value:a.getAttribute(b)}else"value"===b?a[b]=c:a.setAttribute(b,c)},css:function(a,b,c){var d;if(window.getComputedStyle&&(d=window.getComputedStyle(a,null)),d)if(void 0===c||null===c){if(!DD.isObject(b))return d[b];DD.getOwnProps(b).forEach(function(c){void 0!==DD.cssconfig&&void 0!==DD.cssconfig[c]?DD.cssconfig[c].forEach(function(d){a.style[d]=b[c]}):a.style[c]=b[c]})}else void 0!==DD.$cssconfig&&void 0!==DD.$cssconfig[b]?DD.$cssconfig[b].forEach(function(b){a.style[b]=c}):a.style[b]=c},width:function(a,b){if(!DD.isNumber(b)){var c;if(window.getComputedStyle&&(c=window.getComputedStyle(a,null)),!c)return null;var d=parseInt(c.width);if(b===!0){var e=parseInt(c.paddingLeft)+parseInt(c.paddingRight);d-=e}return d}a.style.width=b+"px"},addClass:function(a,b){var c=a.className.trim();if(DD.isEmpty(c))a.className=b;else{for(var d=c.split(/\s+/),e=0;e<d.length;e++)if(d[e]===b)return;d.push(b),a.className=d.join(" ")}},removeClass:function(a,b){var c=a.className.trim();if(!DD.isEmpty(c))for(var d=c.split(/\s+/),e=0;e<d.length;e++)if(d[e]===b)return d.splice(e,1),void(a.className=d.join(" "))},formatDate:function(a,b){if(DD.isString(a)){var c=new RegExp(/^\d+$/);if(null!==c.exec(a))try{a=parseInt(a)}catch(d){}}var a=new Date(a),e={"M+":a.getMonth()+1,"d+":a.getDate(),"h+":a.getHours()%12===0?12:a.getHours()%12,"H+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),S:a.getMilliseconds()},f={0:"日",1:"一",2:"二",3:"三",4:"四",5:"五",6:"六"};return/(y+)/.test(b)&&(b=b.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length))),DD.getOwnProps(e).forEach(function(a){new RegExp("("+a+")").test(b)&&(b=b.replace(RegExp.$1,1==RegExp.$1.length?e[a]:("00"+e[a]).substr((""+e[a]).length)))}),/(E+)/.test(b)&&(b=b.replace(RegExp.$1,(RegExp.$1.length>1?RegExp.$1.length>2?"/u661f/u671f":"/u5468":"")+f[a.getDay()+""])),b},toDate:function(a){var b;try{b=new Date(Date.parse(a))}catch(c){throw DD.Error.handle("invoke","DD.toDate",0,"date string")}return(isNaN(b)||isNaN(b.getDay()))&&(14===a.length?(a=a.substr(0,4)+"/"+a.substr(4,2)+"/"+a.substr(6,2)+" "+a.substr(8,2)+":"+a.substr(10,2)+":"+a.substr(12),b=new Date(Date.parse(a))):8===a.length&&(a=a.substr(0,4)+"/"+a.substr(4,2)+"/"+a.substr(6,2),b=new Date(Date.parse(a)))),b},compileStr:function(a){for(var b,c=new RegExp(/\{.+?\}/),d=arguments;null!==(b=c.exec(a));){var e,f=b[0].substr(1,b[0].length-2),g=parseInt(f)+1;e=void 0!==d[g]?d[g]:"",a=a.replace(c,e)}return a},parseJson:function(a){a=a.trim();var b=a.substr(1,a.length-2).split(","),c={},d=new RegExp(/\'/g);new RegExp(/\"/g);return b.forEach(function(a){var b=a.split(":");if('"'!==b[0]&&"'"!==b[0]||'"'!==b[b.length-1]&&"'"!==b[b.length-1]){var e=b[0].replace(d,"\\'"),f=b[1],g=f.length;g>2&&('"'===f[0]&&'"'===f[g-1]||'"'===f[0]&&'"'===f[g-1])&&(f=f.substr(1,g-2)),c[e]=f}}),c},request:function(a){var b=new XMLHttpRequest,c=a.async===!1?!1:!0,d=a.type||"text";switch(d){case"html":b.overrideMimeType("text/html;charset=utf-8");break;case"json":b.overrideMimeType("text/javascript;charset=utf-8");break;case"js":b.overrideMimeType("text/javascript;charset=utf-8");break;case"xml":b.overrideMimeType("text/xml;charset=utf-8");break;default:b.overrideMimeType("text/plain;charset=utf-8")}b.timeout=a.timeout||0,"function"==typeof a.successFunc&&(b.onload=function(c){switch(b.status){case 200:var d=b.responseText;switch(a.type){case"json":d=JSON.parse(d);break;case"js":var e=DD.newEl("script");e.innerHTML=d;var f=DD.get("head");f.appendChild(e),e.innerHTML="",e.src=a.url,d=e}a.successFunc.call(b,d);break;default:DD.isFunction(a.errorFunc)&&a.errorFunc.call(b,b.status)}}),DD.isFunction(a.errorFunc)&&(b.onerror=a.errorFunc),DD.isFunction(a.timeoutFunc)&&(b.ontimeout=a.timeoutFunc);var e=a.reqType||"GET",f=a.url;switch(e){case"GET":var g;if(DD.isObject(a.params)){var h=[];DD.getOwnProps(a.params).forEach(function(b){h.push(b+"="+a.params[b])}),g=h.join("&")}void 0!==g&&(f+=-1!==f.indexOf("?")?"&"+g:"?"+g),b.open(e,f,c,a.user,a.pwd),b.send(null);break;case"POST":var i=new FormData;for(var j in a.params)i.append(j,a.params[j]);b.open(e,f,c,a.user,a.pwd),b.send(i)}}};DD.config={renderTick:200,appPath:""},DD.Error={handle:function(a){var b=(new RegExp(/\{.+?\}/),DD.ErrorMsgs[a]);if(void 0===b)return"未知错误";for(var c=[b],d=1;d<arguments.length;d++)c.push(arguments[d]);return DD.compileStr.apply(DD,c)}},function(){var a=function(a){var b=this;b.events=[],b.view=a.view,b.handler=a.handler,b.eventName=a.eventName,b.delg=a.delg||!1,b.nopopo=a.nopopo||!1,b.once=a.once||!1,b.capture=a.capture||!1,b.delg?b.delegate():b.bind()};a.prototype.fire=function(a){function b(){for(var b=0;b<d.events.length;b++){var c=d.events[b];if(c.view.contains(a.target)){if(c.nopopo&&a.stopPropagation(),c.handler.call(d.view.$module,a,c.view.$getData().data,c.view),c.once&&d.events.splice(b--,1),c.nopopo)return!1;break}}return!0}function c(){DD.isFunction(d.handler)&&(d.nopopo&&a.stopPropagation(),d.handler.call(d.view.$module,a,d.view.$getData().data,d.view),d.once&&delete d.handler)}var d=this;void 0!==d.view&&(d.capture?(c(),b()):b()&&c(),0===d.events.length&&void 0===d.handler&&(DD.Event.TouchEvents[d.eventName]?DD.Event.unregist(d):d.view.removeEventListener(d.eventName,d.handleEvent)))},a.prototype.bind=function(a){var b=this;b.view.$events[b.eventName]||(DD.Event.TouchEvents[b.eventName]?DD.Event.regist(b):(b.handleEvent=function(a){b.fire(a)},b.view.addEventListener(b.eventName,b.handleEvent)),b.view.$events[b.eventName]=b)},a.prototype.delegate=function(b){var c=this,d=c.view.parentNode;d||(d=document.body);var e;d.$events[c.eventName]?e=d.$events[c.eventName]:(e=new a({eventName:c.eventName,view:d}),e.bind()),-1===e.events.indexOf(c)&&e.events.push(c)},DD.Event=a,DD.Event.TouchEvents={tap:{touchstart:function(a,b){var c=a.touches[0];b.extParams={pos:{sx:c.pageX,sy:c.pageY,t:Date.now()}}},touchmove:function(a,b){var c=b.extParams.pos,d=a.touches[0],e=d.pageX-c.sx,f=d.pageY-c.sy;(Math.abs(e)>5||Math.abs(f)>5)&&(c.move=!0)},touchend:function(a,b){var c=b.extParams.pos,d=Date.now()-c.t;c.move===!0||d>300||b.fire(a)}},swipe:{touchstart:function(a,b){var c=a.touches[0],d=Date.now();b.extParams={swipe:{oldTime:[d,d],speedLoc:[{x:c.pageX,y:c.pageY},{x:c.pageX,y:c.pageY}],oldLoc:{x:c.pageX,y:c.pageY}}}},touchmove:function(a,b){var c=Date.now(),d=a.touches[0],e=b.extParams.swipe;c-e.oldTime>50&&(e.speedLoc[0]={x:e.speedLoc[1].x,y:e.speedLoc[1].y},e.speedLoc[1]={x:d.pageX,y:d.pageY},e.oldTime[0]=e.oldTime[1],e.oldTime[1]=c),e.oldLoc={x:d.pageX,y:d.pageY}},touchend:function(a,b){var c=b.extParams.swipe,d=Date.now(),e=d-c.oldTime[1]<30?0:1,f=c.oldLoc.x-c.speedLoc[e].x,g=c.oldLoc.y-c.speedLoc[e].y,h=Math.sqrt(f*f+g*g),i=d-c.oldTime[e],j=h/i;if(j>.05){var k="";0>f&&Math.abs(g/f)<1&&(a.v0=j,k="swipeleft"),f>0&&Math.abs(g/f)<1&&(a.v0=j,k="swiperight"),g>0&&Math.abs(f/g)<1&&(a.v0=j,k="swipedown"),0>g&&Math.abs(f/g)<1&&(a.v0=j,k="swipeup"),b.eventName===k&&b.fire(a)}}}},DD.Event.TouchEvents.swipeleft=DD.Event.TouchEvents.swipe,DD.Event.TouchEvents.swiperight=DD.Event.TouchEvents.swipe,DD.Event.TouchEvents.swipeup=DD.Event.TouchEvents.swipe,DD.Event.TouchEvents.swipedown=DD.Event.TouchEvents.swipe,DD.Event.regist=function(a){var b=DD.Event.TouchEvents[a.eventName];DD.isEmpty(a.touchListeners)||DD.Event.unregist(a),a.touchListeners={},b&&DD.getOwnProps(b).forEach(function(c){a.touchListeners[c]=function(d){b[c](d,a)},a.view.addEventListener(c,a.touchListeners[c])})},DD.Event.unregist=function(a){var b=DD.Event.TouchEvents[a.eventName];b&&DD.getOwnProps(a.touchListeners).forEach(function(b){a.view.removeEventListener(b,a.touchListeners[b])})}}(),function(){var M=function(){};M.prototype.handle=function(a,b,c){var d=this,e="";return DD.isArray(b)?(b.forEach(function(b){e+="string"===b.type?b.src:d.cacExpr(a,b.src,c)}),e):void 0},M.prototype.initExpr=function(a,b){for(var c,d=this,e=new RegExp(/\{\{.+?\}\}/g),f=[],g=0;null!==(c=e.exec(a));)c.index>g&&f.push({type:"string",src:a.substring(g,c.index)}),f.push({type:"expr",src:d.initOne(c[0].substring(2,c[0].length-2),b)}),g=c.index+c[0].length;return g<a.length-1&&f.push({type:"string",src:a.substr(g)}),f},M.prototype.initOne=function(expStr,view){function genStack(a){for(var b=[],c=[],d=0,e=0;e<a.length;e++)for(var f=cacSign.length-1;f>=0;f--){var g=cacSign[f].length;if(a.substr(e,g)===cacSign[f]){b.push(a.substr(d,e-d).trim()),c.push(cacSign[f]),e+=g-1,d=e+1;break}}return d<a.length&&b.push(a.substr(d).trim()),[b,c]}function getParams(a){var b=[],c=a.substring(a.indexOf("(")+1,a.lastIndexOf(")"));if(""!==c&&""!==(c=c.trim())){var d=c.split(",");d.forEach(function(a){a=a.trim();for(var c=0;c<strArr.length;c++)if(strPrev+c===a)return void b.push({type:"string",src:strArr[c]});var d;d=isNaN(a)?{type:"field",src:a}:{type:"number",src:a},b.push(d),void 0!==view&&"field"===d.type&&bindOne(d)})}return b}function initFilter(){for(var a=0;a<stacks[1].length;a++)if("|"===stacks[1][a]){var b={type:"filter",exprs:[stacks[0][a],stacks[0][a+1]],signs:[]},c=a,d=stacks[1][a-1],e=0;if(")"===d){e++,b.exprs[0]=stacks[0][a-1],stacks[0].splice(a);for(var f=a-2;f>=0;f--)if(")"===stacks[1][f])e++;else if("("===stacks[1][f]&&0===--e){c=f;break}b.signs.unshift(d);for(var f=a-2;f>=c;f--)b.exprs.unshift(stacks[0][f]),b.signs.unshift(stacks[1][f])}stacks[0].splice(c,a-c+2,b),stacks[1].splice(c,a-c+1),a=c}}for(var cacSign=["(",")","!","|","*","/","+","-",">","<",">=","<=","==","===","&&","||","%"],regFun=new RegExp(/[\w$][\w$\d\.]*\(.*?\)/),regStr=new RegExp(/(\'.+?\')|(\".+?\")/),funPrev="$DDfun_rep_",strPrev="$DDstr_rep_",funArr=[],strArr=[],repIndex=0,r;null!==(r=regStr.exec(expStr));)expStr=expStr.replace(r[0],strPrev+repIndex++),strArr.push(r[0]);for(repIndex=0;null!==(r=regFun.exec(expStr));)expStr=expStr.replace(r[0],funPrev+repIndex++),funArr.push(r[0]);var stacks=genStack(expStr),stack1=[];return stacks[0].forEach(function(item,ii){for(var i=0;i<funArr.length;i++)if(-1!==item.indexOf(funPrev+i)){var ind1=funArr[i].indexOf("("),fn=funArr[i].substr(0,ind1).trim(),pm=getParams(funArr[i]);return void stack1.push({type:"function",fn:fn,params:pm})}for(var i=0;i<strArr.length;i++)if(-1!==item.indexOf(strPrev+i))return void stack1.push({type:"string",src:item.replace(strPrev+i,strArr[i])});""===item?stack1.push({type:"blank",src:item}):isNaN(item)?"true"===item||"false"===item?stack1.push({type:"bool",src:eval(item)}):stack1.push({type:"field",src:item}):stack1.push({type:"number",src:eval(item)})}),stacks[0]=stack1,initFilter(),stacks},M.prototype.cacExpr=function(module,stacks,model){function invoke(funObj){var foo,isSystem=!1;-1===funObj.fn.indexOf(".")?foo=module.methodFactory.get(funObj.fn):(isSystem=!0,foo=eval(funObj.fn));var pa=[];return funObj.params.forEach(function(p){switch(p.type){case"field":var v=getValue(module,p.src,model);pa.push(v);break;case"number":pa.push(eval(p.src));break;default:pa.push(p.src)}}),isSystem?foo.apply(null,pa):foo.apply(module,pa)}function filter(filterObj){for(var exprs=filterObj.exprs,signs=filterObj.signs,src,r="",i=0;i<exprs.length-1;i++)r+=cacOne(exprs[i]),i<signs.length&&(r+=signs[i]);if(signs.length>0)try{r=eval(r)}catch(e){}return DD.Filter.handle(module,r,exprs[i].src)}function cacOne(a){function b(a){if(!hasCac)return a;if(DD.isString(a)){var b=a.indexOf("'");-1!==b?b>0&&(a='"'+a+'"'):((b=a.indexOf('"'))>0||-1===b)&&(a="'"+a+"'")}return a}switch(a.type){case"field":var c=getValue(module,a.src,model);return b(c);case"function":return b(invoke(a));case"filter":return filter(a);default:return a.src}}function getValue(a,b,c){for(var d=[c.data,a.data],e=c.aliasName,f=0;f<d.length;f++){var g=d[f];if(null!==g&&void 0!==g){if(b===e)return g;if(b===c.indexName)return c.index;if(DD.isEmpty(e)||0!==b.indexOf(e+".")||(b=b.substr(e.length+1)),b===c.indexName)return c.index;if(DD.isFunction(g.$get)){var h=g.$get(b);if(void 0!==h)return h}}}return""}for(var expr="",hasCac=!1,i=0;i<stacks[1].length;i++)if(""!==stacks[1][i]){hasCac=!0;break}if(stacks[0].forEach(function(a,b){var c=cacOne(a),d="";b<stacks[1].length&&(d=stacks[1][b]),expr+=c+d}),hasCac)try{""!==expr&&(expr=eval(expr))}catch(e){}return expr},DD.Expression=new M}(),function(){function initmodel(a){for(var b,c,d=this,e=d.parentNode;e&&e!==d.$module.view;e=e.parentNode)if(e.$modelStr){b=e.$modelStr,e.$model&&(c=e.$model);break}if(!DD.isEmpty(a)&&b&&c&&c.aliasName)if(a===c.aliasName)a=null;else if(-1!==a.indexOf(".")){var f=a.split(".");f[0]===c.aliasName&&f.shift(),a=f.join(".")}d.$modelStr=a}function initrepeat(a){var b,c,d,e=this,f=a.split(" in ");f[0]=f[0].trim(),f[1]=f[1].trim();var b,g;if("("===f[0].charAt(0)&&")"===f[0].charAt(f[0].length-1)){var h=f[0].substr(1,f[0].length-2).split(",");b=h[0].trim(),g=h[1].trim()}else b=f[0];var i,j;c=f[1],-1!==(j=c.indexOf("|"))?(d=c.substr(0,j).trim(),i=c.substr(j+1).trim()):d=c;var k={name:"model",value:d};e.$directives.push(k),initmodel.call(e,d);var l=e.$getDirective("repeat");l.value=d,l.filter=i,l.done=!1,e.$model.aliasName=b,e.$model.indexName=g;var m=document.createTextNode("");DD.replaceNode(e,m),m.$savedDoms.repeat=e,e.$removeDirective("repeat")}function initif(a){var b=this,c=b.nextElementSibling,d=b.$getDirective("if");d.value=DD.Expression.initExpr("{{"+d.value+"}}");var e=[b];DD.isEl(c)&&c.hasAttribute("x-else")?(d.hasElse=!0,e.push(c)):d.hasElse=!1;var f=document.createTextNode("");DD.replaceNode(b,f),b.$removeDirective("if"),f.$savedDoms["if"]=e}function initelse(a){this.$removeDirective("else"),DD.remove(this)}function initshow(a){var b=this,c=b.$getDirective("show");c.value=DD.Expression.initExpr("{{"+c.value+"}}")}function initclass(value){var view=this,d=view.$getDirective("class"),obj=eval("("+value+")");if(DD.isObject(obj)){var robj={};DD.getOwnProps(obj).forEach(function(a){DD.isString(obj[a])&&(robj[a]=DD.Expression.initExpr("{{"+obj[a]+"}}",view.$module))}),d.value=robj}}function initfield(){var a,b,c=this,d=c.$getDirective("field").value;b=-1!==(a=d.indexOf("|"))?d.substr(0,a):d;var e=c.tagName.toLowerCase(),f="input";"input"!==e||"checkbox"!==c.type&&"radio"!==c.type||(f="change"),"radio"!==c.type&&(c.$attrs.value=DD.Expression.initExpr("{{"+d+"}}",c)),new DD.Event({view:c,eventName:f,handler:function(a,c,d){"checkbox"===d.type&&(DD.attr(d,"yes-value")===d.value?d.value=DD.attr(d,"no-value"):d.value=DD.attr(d,"yes-value")),c.data[b]=d.value}})}function domodel(a){function b(a){for(var c=0;c<a.childNodes.length;c++){var d=a.childNodes[c];d.$isView&&d.$hasDirective("model")&&delete d.$model.data,b(d)}}var c=this;c.$model=c.$getData(),b(c)}function dorepeat(a){var b=this;DD.isEmpty(a)&&(a=b.$getDirective("repeat")),b.$model.data=null;var c=b.$getData();if(void 0!==c.data&&DD.isArray(c.data)&&0!==c.data.length){var d=[];d=a.filter?DD.Filter.handle(b.$module,c.data,a.filter):c.data;for(var e=[],f=b.nextElementSibling;null!==f&&f.$fromNode===b;)e.push(f),f=f.nextElementSibling;var g,g=b;d.forEach(function(a,c){var d;c<e.length?d=e[c]:(d=DD.cloneNode(b.$savedDoms.repeat),d.$fromNode=b,DD.insertAfter(d,g)),d.$modelStr=b.$modelStr,g=d,d.$model.data=a,d.$model.indexName&&(d.$model.data[d.$model.indexName]=c)});for(var h=e.length-1;h>=d.length;h--)DD.remove(e[h])}}function doif(a){var b=this;DD.isEmpty(a)&&(a=b.$getDirective("if"));var c=b.$getData(),d=DD.Expression.handle(b.$module,a.value,c);d=d&&"false"!==d?!0:!1;var e;if(d){if(a.yes===!0)return;e=b.$savedDoms["if"][0]}else if(a.hasElse){if(a.yes===!1)return;e=b.$savedDoms["if"][1]}if(a.yes=d,null!==b.nextSibling&&b.nextSibling.$fromNode===b&&DD.remove(b.nextSibling),void 0!==e){var f=DD.cloneNode(e);DD.insertAfter(f,b),updModelStr(f),f.$fromNode=b}}function doclass(a){var b=this;if(b.nodeType===Node.ELEMENT_NODE){DD.isEmpty(a)&&(a=b.$getDirective("class"));var c=b.$getData(),d=a.value;DD.getOwnProps(d).forEach(function(a){if(DD.isArray(d[a])){var e=DD.Expression.handle(b.$module,d[a],c);e=e&&"false"!==e?!0:!1,e?DD.addClass(b,a):DD.removeClass(b,a)}})}}function doshow(a){function b(){var b=c.$getData(),d=DD.Expression.handle(c.$module,a.value,b);if(d=d&&"false"!==d?!0:!1){if(a.yes===!0)return;DD.css(c,"display",a.display),updModelStr(c)}else{if(a.yes===!1)return;DD.css(c,"display","none")}a.yes=d}var c=this;DD.isEmpty(a)&&(a=c.$getDirective("show")),void 0===a.display?setTimeout(function(){var d=DD.css(c,"display");d&&"none"!==d||(d="block"),a.display=d,b()},0):b()}function updModelStr(a,b){var c=a.$modelStr;if(b)a.$hasDirective("model")&&initmodel.call(a,a.$getDirective("model").value);else if(c){a.$model&&a.$model.index>=0&&(a.$modelStr+="["+a.$model.index+"]")}for(var d=0;d<a.childNodes.length;d++){var e=a.childNodes[d];e.$isView&&updModelStr(e,!0)}}function dofield(a){var b=this,c=b.type,d=b.tagName.toLowerCase();if("radio"===c||"checkbox"===c||"select"===d){var e=b.$getData(),f=e.data[a.value];if("radio"===c){var g=b.value;f==g?DD.attr(b,"checked","checked"):b.removeAttribute("checked")}else if("checkbox"===c){var h=DD.attr(b,"yes-value");f==h?(DD.attr(b,"checked","checked"),b.value=h):(b.removeAttribute("checked"),b.value=DD.attr(b,"no-value"))}else"select"===d&&setTimeout(function(){b.value=f},0)}}var M=function(){var a=this;a.factory={},a.directives={model:{preOrder:1,sys:!0,once:!1,init:initmodel,handler:domodel},"class":{preOrder:1,once:!1,sys:!0,init:initclass,handler:doclass},repeat:{preOrder:6,once:!1,sys:!0,init:initrepeat,handler:dorepeat},"if":{preOrder:5,once:!1,sys:!0,init:initif,handler:doif},"else":{preOrder:5,once:!1,sys:!0,init:initelse},show:{preOrder:5,sys:!0,init:initshow,handler:doshow},field:{preOrder:5,init:initfield,handler:dofield}}};M.prototype.add=function(a){var b=this;b.directives[a.directiveName]=a},M.prototype.remove=function(a){var b=this;delete b.directives[a]},M.prototype.get=function(a){return this.directives[a]},M.prototype.initViewDirectives=function(a){var b=this,c=DD.getAttrs(a,/^x-/);c.length>1&&c.sort(function(a,c){var d,e,f,g;return f=a.name.substr(2),g=c.name.substr(2),d=b.directives[f],e=b.directives[g],d.preOrder-e.preOrder}),c.forEach(function(b){a.removeAttribute(b.name)}),c.forEach(function(c){var d=c.name.substr(2),e=c.value;a.$directives.push({name:d,value:e}),void 0!==b.directives[d]&&DD.isFunction(b.directives[d].init)&&b.directives[d].init.call(a,e)})},M.prototype.initViewDirective=function(a,b){var c=this;b.length>1&&b.sort(function(a,b){var d,e;return d=c.directives[a.name],e=c.directives[b.name],d.preOrder-e.preOrder}),b.forEach(function(b){b.value;void 0!==a.$getDirective(b.name)&&a.$removeDirective(b.name),void 0!==c.directives[b.name]&&DD.isFunction(c.directives[b.name].init)&&c.directives[b.name].init.call(a,b.value)})},M.prototype.handle=function(a){var b=this,c=[];if(a.$directives.forEach(function(d){var e=d.name,f=b.directives[e];void 0!==f&&DD.isFunction(f.handler)&&(f.handler.call(a,d),f.once===!0&&c.push(a.$directives.indexOf(d)))}),c.length>0)for(var d=c.length-1;d>=0;d--)a.$directives.splice(c[d],1)},DD.Directive=new M,DD.Directive.create=function(a){(void 0===a.preOrder||a.preOrder<10)&&(a.preOrder=10),a.once=a.once||!1,DD.Directive.directives[a.name]=a},DD.Directive.remove=function(a){DD.Directive.directives[a];delete DD.Directive.directives[a]},DD.createDirective=DD.Directive.create,DD.removeDirective=DD.Directive.remove}(),function(){var M=function(){var me=this;me.cantEditFilters=["date","currency","number","tolowercase","touppercase","orderBy","filter"],me.filters={date:function(a,b){var c=b[0];return c=c.substr(1,c.length-2),DD.formatDate(a,c)},currency:function(a,b){var c;return DD.isArray(b)&&(c=b[0]),"string"==typeof a&&(a=parseFloat(a)),DD.isEmpty(c)&&(c="¥"),c+me.filters.number(a,[2])},number:function(a,b){var c=b[0]||0;return"string"==typeof a&&(a=parseFloat(a)),a.toFixed(c)},tolowercase:function(a){return a.toLowerCase()},touppercase:function(a){return a.toUpperCase()},orderBy:function(a,b){var c=b[0],d=b[1]||"asc",e=a.concat([]);return e.sort(function(a,b){return"asc"===d?a[c]>b[c]:a[c]<b[c]}),e},select:function(array,pa){var me=this,handler={odd:function(a){for(var b=[],c=0;c<a.length;c++)c%2===1&&b.push(a[c]);return b},even:function(a){for(var b=[],c=0;c<a.length;c++)c%2===0&&b.push(a[c]);return b},range:function(a,b){var c,d;return isNaN(b[0])||(c=parseInt(b[0])),isNaN(b[1])||(d=parseInt(b[1])),a.slice(c,d+1)},index:function(a,b){var c=[],d=a.length;return b.length>0&&b.forEach(function(b){isNaN(b)||(parseInt(b),b>=0&&d>b&&c.push(a[b]))}),c},func:function(a,b){var c=me.methodFactory.get(b[0]);return DD.isFunction(c)?c(a):a},value:function(arr,param){var ret=[];if("{"===param[0]&&"}"===param[param.length-1]&&(param=eval("("+param+")")),DD.isObject(param)){var keys=DD.getOwnProps(param);return arr.filter(function(a){for(var b=0;b<keys.length;b++){var c=a[keys[b]],d=param[keys[b]];if("string"==typeof c&&-1!==c.indexOf(d)||c===d)return!0}return!1})}return arr.filter(function(a){for(var b=DD.getOwnProps(a),c=0;c<b.length;c++){var d=a[b[c]];if(DD.isString(d)&&-1!==d.indexOf(param))return a}})}},type=pa[0].trim();return handler.hasOwnProperty(type)||(type="value"),"range"===type||"index"===type||"func"===type?handler[type].call(me,array,pa.slice(1)):"value"===type?handler[type].call(me,array,pa[0]):handler[type].call(me,array)}}};M.prototype.handle=function(a,b,c){var d=this;if(DD.isEmpty(b))return"";if(DD.isEmpty(c))return b;for(var e,f="$DD_rparam_",g=new RegExp(/(\{.+?\})|(".+?")|('.+?')/g),h=[],i=0;null!==(e=g.exec(c));)h.push(e[0]),c=c.replace(e[0],f+i++);var j=c.split("|");return j.forEach(function(c){if(!DD.isEmpty(c.trim())){for(var e=c.split(":"),g=0;g<e.length;g++)e[g]=e[g].trim();var i=e[0];if(h.length>0)for(var j=1;j<e.length;j++)for(var g=0,k=h.length;k>g;g++)e[j]=e[j].trim().replace(f+g,h[g]);DD.isFunction(d.filters[i])&&(b=d.filters[i].call(a,b,e.slice(1)))}}),b},M.prototype.add=function(a,b){var c=this;c.filters[a]=b},M.prototype.remove=function(a){var b=this;delete b.filters[a]},DD.Filter=new M}(),function(){var a=function(){var a=this;a.methods={}};a.prototype={add:function(a,b){var c=this;c.methods[a]=b},remove:function(a){var b=this;delete b.methods[a]},get:function(a){return this.methods[a]}},DD.MethodFactory=a}(),function(){var a=function(a){var b=this,c=a.data;return b.$module=a.module,b.$module.data=c,DD.isObject(c)?b.createObjectModel(c):DD.isArray(c)&&b.createArrayModel(c),c},b={$fields:{},$set:function(a,b){var c,d,e=this,f=a.split("."),g=e;for(d=0;d<f.length-1&&(c=f[d],g=g[c],void 0!==g);d++);void 0===g[f[d]]&&Object.defineProperty(g,f[d],{set:function(a){e.$model.setProp(g,f[d],a)},get:function(){return e.$model.getProp(g,f[d])}}),DD.isObject(b)?e.$model.createObjectModel(b):DD.isArray(b)&&e.$model.createArrayModel(b),g[f[d]]=b},$get:function(a){for(var b=this,c=a.split("."),d=0;d<c.length&&b&&b.$model;d++)if(c[d].lastIndexOf("]")===c[d].length-1){var e=c[d].split("[");b=b[e[0]],e.shift(),e.forEach(function(a){var c=a.substr(0,a.length-1);b=b[parseInt(c)]})}else b=b[c[d]];return b}};a.prototype.setProp=function(a,b,c){var d=this,e=a.$fields[b]!==c;e&&(DD.isObject(c)?d.createObjectModel(c):DD.isArray(c)&&d.createArrayModel(c),a.$fields[b]=c,d.change())},a.prototype.getProp=function(a,b){return a.$fields[b]},a.prototype.change=function(){DD.Renderer.add(this.$module)},a.prototype.createObjectModel=function(a){var c=this;DD.merge(a,b),a.$model=c,DD.getOwnProps(a).forEach(function(b){if("$"!==b[0]&&!DD.isFunction(a[b])){var d=a[b];DD.isObject(a[b])&&c.createObjectModel(a[b]),DD.isArray(a[b])&&c.createArrayModel(a[b]),Object.defineProperty(a,b,{set:function(d){c.setProp(a,b,d)},get:function(){return c.getProp(a,b)}}),a[b]=d}})},a.prototype.createArrayModel=function(a){var b=this;a.$model=b;for(var c=0;c<a.length;c++){var d=a[c];DD.isObject(d)&&b.createObjectModel(d),DD.isArray(d)&&b.createArrayModel(d)}var e=["push","unshift","splice","pop","shift","reverse","sort"];e.forEach(function(c){a[c]=function(){Array.prototype[c].apply(a,arguments);var d=[];switch(c){case"push":d=arguments;break;case"unshift":d=arguments;break;case"splice":if(arguments.length>2)for(var e=2;e<arguments.length;e++)d.push(arguments[e])}for(var e=0;e<d.length;e++){var f=d[e];DD.isObject(f)&&b.createObjectModel(f),DD.isArray(f)&&b.createArrayModel(f)}b.change()}})},DD.Model=a}(),function(){var a=function(a){var b=this;return b.name=a.name||"DDModule_"+DD.genId(),b.methodFactory=new DD.MethodFactory,b.events={},b.modules=[],b.compiled=!1,b.inited=!1,b.onReceive=a.onReceive,b.onInit=a.onInit,b.fromModules=a.fromModules,b.onRender=a.onRender,b.onFirstRender=a.onFirstRender,b.initConfig=DD.merge({delayInit:!1},a),b.el=b.initConfig.el,DD.isEmpty(a.methods)||DD.getOwnProps(a.methods).forEach(function(c){b.methodFactory.add(c,a.methods[c])}),delete a.methods,b.initConfig.delayInit||b.init(a),a.root===!0&&(DD.App=b),b};a.prototype.init=function(b){var c=this,d=c.initConfig;d.parent instanceof a&&(c.parent=d.parent),c.virtualDom=DD.newEl("div");var e,f;e=c.parent?c.parent.$rendered?c.parent.view:c.parent.virtualDom:document.body,f=DD.get(d.el,!1,e),f&&f.childNodes&&DD.transChildren(f,c.virtualDom),c.load(function(a,e){if(!DD.isEmpty(e)){var f=DD.newEl("div");f.innerHTML=e,DD.transChildren(f,c.virtualDom)}c.compile(),DD.Renderer.add(c),a&&(c.data=new DD.Model({data:a,module:c})),DD.isArray(d.modules)&&d.modules.forEach(function(a){c.addModule(a)}),DD.isFunction(d.onInit)&&d.onInit.call(c),DD.isFunction(b)&&b(c),delete c.initConfig}),c.inited=!0},a.prototype.load=function(a){function b(){DD.isFunction(a)&&0===i&&a(e,f)}function c(){DD.isArray(h.requires)&&h.requires.length>0&&h.requires.forEach(function(a){var c,d="js";switch(DD.isObject(a)?(c=a.path,d=a.type||d):"string"==typeof a&&(c=a),d){case"css":var e=DD.get("link[href='"+c+"']");if(null!==e)return;var f=DD.newEl("link");f.type="text/css",f.rel="stylesheet",f.href=c;var g=DD.get("head");null===g&&(g=document.body),g.append(f);break;default:var e=DD.get("script[src='"+c+"']");if(null!==e)return;i++,DD.request({url:c,type:d,successFunc:function(){0===--i&&b()}})}})}function d(){if(DD.isObject(h.data)?e=h.data:DD.isEmpty(h.dataUrl)||(i++,DD.request({url:h.dataUrl,type:"json",successFunc:function(a){e=a,0===--i&&b()}})),DD.isEmpty(h.template)){if(!DD.isEmpty(h.templateUrl)){var a=h.templateUrl;DD.config&&!DD.isEmpty(DD.config.appPath)&&(a=DD.config.appPath+"/"+a),i++,DD.request({url:a,successFunc:function(a){f=a,0===--i&&b()}})}}else f=h.template}var e,f,g=this,h=g.initConfig,i=0;c(),d(),0===i&&b()},a.prototype.compile=function(a){function b(a){DD.merge(a,DD.extendElementConfig),a.$module=d,DD.getAttrsByValue(a,/\{\{.+?\}\}/).forEach(function(b){d.needData=!0,a.$attrs[b.name]=DD.Expression.initExpr(b.value,a)}),DD.Directive.initViewDirectives(a),a.$hasDirective("model")&&(d.needData=!0);for(var c=a.childNodes,e=0;e<c.length;e++){var f=c[e];switch(f.nodeType){case Node.TEXT_NODE:/\{\{.+\}\}?/.test(f.textContent)&&(d.needData=!0,f.$exprs=DD.Expression.initExpr(f.textContent,d),f.textContent="");break;case Node.COMMENT_NODE:a.removeChild(f),e--;break;default:b(f)}}return a}var c,d=this;if(d.compiled=!1,d.className&&void 0!==(c=DD.Module.getClass(d.className))&&null!==c.virtualDom)return void(d.virtualDom=c.virtualDom);if(a)b(a);else{var e=b(d.virtualDom);void 0!==c&&(c.virtualDom=e),d.compiled=!0}},a.prototype.render=function(a,b){function c(a,b){if(a.$isRouterView===!0&&(f.routerView=a),a.$module=f,a===f.view||!a.$containModule){if(a.$isView){!a.$rendered&&DD.isEl(a)&&e(a);var d=a.$getData();if(DD.isEl(a)){var g=[];DD.getOwnProps(a.$attrs).forEach(function(b){if("function"!=typeof a.$attrs[b]){var c=DD.Expression.handle(f,a.$attrs[b],d);
"x-"===b.substr(0,2)?g.push({name:b.substr(2),value:c}):DD.attr(a,b,c)}}),g.length>0&&DD.Directive.initViewDirective(a,g)}if(DD.Directive.handle(a),a.childNodes)for(var h=0;h<a.childNodes.length;h++)c(a.childNodes[h]);a.$rendered=!0}else if(f.data&&a.nodeType===Node.TEXT_NODE&&a.$exprs){var d=a.parentNode.$getData();if(d.data){for(var i=DD.Expression.handle(f,a.$exprs,d),j=a.nextSibling;null!==j&&j.$genNode;){var k=j.nextSibling;DD.remove(j),j=k}var l=document.createElement("div");l.innerHTML=i,f.compile(l);for(var m=document.createDocumentFragment(),n=!1,h=0;h<l.childNodes.length;){var k=l.childNodes[h];DD.isEl(k)&&(n=!0),k.$genNode=!0,m.appendChild(l.childNodes[h])}n?DD.insertAfter(m,a):a.textContent=i}}return a}}function d(a){return a.view||(a.parent?(a.parent.view||d(a.parent),a.parent.view&&(a.view=DD.get(a.el,!1,a.parent.view))):a.view=DD.get(a.el,!1,document.body)),a.view}function e(a){var b=DD.getAttrs(a,/^e-/);b.length>0&&b.forEach(function(b){var c=b.value.split(":"),d=f.methodFactory.get(c[0]);if(d){var e=b.name.substr(2),g={view:a,eventName:e,handler:d};if(c.length>1)for(var h=1;h<c.length;h++)g[c[h]]=!0;console.log(g),new DD.Event(g),a.removeAttribute(b.name)}})}var f=this;if(d(f),!DD.isEl(f.view))return!0;if(f.view.$isView||(DD.merge(f.view,DD.extendElementConfig),f.view.$isView=!0),!f.needData||f.data){if(0===f.view.childNodes.length){var g=DD.cloneNode(f.virtualDom);c(g,!0),DD.transChildren(g,f.view),f.view.$containModule=!0,!f.rendered&&DD.isFunction(f.onFirstRender)&&f.onFirstRender(),f.rendered=!0}else c(f.view,!0);return DD.isFunction(f.onRender)&&f.onRender(),f.renderChildren&&(f.modules.forEach(function(a){a.renderChildren=!0,a.render()}),delete f.renderChildren),DD.Router&&setTimeout(function(){DD.Router.linkLoad()},0),!0}},a.prototype.destroy=function(){delete DD.Module.moduleFactory[this.name],DD.Renderer.remove(this)},a.prototype.addModule=function(a){var b=this;a.parent=b;var c=DD.Module.newInstance(a);return b.modules.push(c),c},a.prototype.setData=function(a){var b=this;DD.getOwnProps(b.data).forEach(function(c){"$"===c[0]&&(a[c]=b.data[c])}),new DD.Model({data:a,module:b})},a.prototype.broadcast=function(a){var b=this;if(b.parent){var c=b.name,d=b.parent.modules;d=d.concat(b.modules),d.push(b.parent),d.forEach(function(d){if(d!==b&&DD.isFunction(d.onReceive)){var e=!0;DD.isArray(d.fromModules)&&0!==d.fromModules.length&&-1===d.fromModules.indexOf(c)&&(e=!1),e&&d.onReceive.call(d,c,a)}})}},DD.assign(a,{classFactory:{},moduleFactory:{},define:function(a){var b=this,c=a.className;return b.classFactory[c]=DD.merge({virtualDom:null},a),b.classFactory[c]},getClass:function(a){return this.classFactory[a]},newInstance:function(a){var b,c=this;if(DD.isEmpty(a.className))b=a;else{var d=c.getClass(a.className);void 0!==d&&(b=DD.extend({},d,a))}var e=new DD.Module(b);return c.moduleFactory[e.name]=e,e},get:function(a){return this.moduleFactory[a]}}),DD.assign(DD,{createModule:function(a){return DD.isArray(a)?void a.forEach(function(a){DD.Module.newInstance(a)}):DD.Module.newInstance(a)},defineModule:function(a){return DD.Module.define(a)}}),DD.Module=a}(),function(){function a(a,b){for(var c,d=a.parentNode;d;d=d.parentNode)"FORM"===d.tagName&&(c=d);return c?[c.querySelector("[name='"+b+"']"),c]:null}function b(a){var b,c,d=this,e=a;-1!==(b=a.indexOf("|"))&&(e=a.substr(0,b),c=a.substr(b+1)),d.$validity={fn:e,tips:{},method:c};for(var f=d.children,g=0;g<f.length;g++){var h=f[g].getAttribute("rel");d.$validity.tips[h]=f[g]}d.$savedDoms.validity=d,DD.empty(d);var i=document.createTextNode("");DD.replaceNode(d,i)}function c(b){function c(a){for(var b=0;b<a.length;b++)switch(a[b]){case"valueMissing":return"required";case"typeMismatch":return"type";case"tooLong":return"maxLength";case"tooShort":return"minLength";case"rangeUnderflow":return"min";case"rangeOverflow":return"max";case"patternMismatch":return"pattern"}}var d=this;if(DD.isEmpty(b)&&(b=d.$getDirective("validity")),d.$validity){var e=a(d,d.$validity.fn);if(e){var f=e[0],g=e[1];DD.$validity.form!==g&&(DD.$validity.valid=!0,DD.$validity.form=g),d.nextSibling.$fromNode===d&&DD.remove(d.nextSibling);var h;if(null!==f){var i=[];if(d.$validity.method){var j=d.$module.methodFactory.get(d.$validity.method);if(DD.isFunction(j)){var k=j.call(d.$module,f.value);k||i.push("custum")}}var l=f.validity;if(!l.valid)for(var m in l)l[m]===!0&&i.push(m);if(i.length>0){DD.$validity.valid=!1;var h=c(i),n=d.$validity.tips,o=d.$savedDoms.validity.cloneNode(!1);if(o.$fromNode=d,DD.isEl(n[h]))o.appendChild(n[h]);else{var p=document.createTextNode(DD.compileStr(DD.FormMsgs[h],DD.attr(f,h)));o.appendChild(p)}DD.insertAfter(o,d)}}}}}DD.Directive.create({name:"validity",preOrder:5,init:b,handler:c}),DD.$validity={valid:!0,form:null,check:function(){return DD.$validity.valid}}}(),function(){DD.Router={routes:[],links:[],currentLinks:[],waitLinks:[],root:"",donop:!1,loading:!1,switching:!1,"switch":{style:"none",switchTime:"1s"},currentState:null,history:0,currentPath:void 0,addRoute:function(a){var b=this;a.parent||b.routes.push(a)},removeRoute:function(a){var b,c=this;b=a.parent?a.parent.routes:c.routes,b.splice(b.indexOf(a),1)},linkLoad:function(){var a=this;if(a.links.length>0){var b=a.links.shift();b.start(b.path)}else a.loading=!1},find:function(a){var b=this,c=b.getRouteLink(a);return c.length>0?c[c.length-1]:null},getRouteLink:function(a){function b(a,c){if(!DD.isArray(a)||DD.isEmpty(c))return null;for(var e,f=0;f<a.length;f++){var g=a[f];if(g.path===c)return d.push(g),g;0===c.indexOf(g.path+"/")&&(!e||e.path.length<g.path.length)&&(e=g)}if(e){var h=c.substr(e.path.length),i=h.substr(1).split("/");if("param"===e.type){for(var j=i.length<=e.paramNames.length?i.length:e.paramNames.length,k={},f=0;j>f;f++)k[e.paramNames[f]]=i[f];if(e.newData=k,d.push(e),i.length<=e.paramNames.length)return e;i.splice(0,e.paramNames.length),h="/"+i.join("/")}else d.push(e);if(DD.isArray(e.routes))return b(e.routes,h)}return null}var c=this,d=[];return b(c.routes,a),d},start:function(a,b){function c(a){a&&(a.view=null,a.modules.forEach(function(a){c(a)}))}var d=this;if(d.loading||"none"!==d["switch"].style&&d.switching)return!1;if(d.currentPath===a)return!0;d.loading=!0,d.links=[];var e=d.getRouteLink(a);if(d.currentLinks.length>0){for(var f=-1,g=e.length>d.currentLinks.length?e.length:d.currentLinks.length,f=g,h=0;g>h;h++)if(d.currentLinks[h]!==e[h]){f=h;break}f===e.length&&d.currentLinks.length>=e.length&&f--,e.splice(0,f);for(var h=d.currentLinks.length-1;h>=f;h--){var i=d.currentLinks[h];c(i.module),DD.isFunction(i.onLeave)&&i.onLeave(),d.currentLinks.pop()}d.currentLinks=d.currentLinks.concat(e)}else d.currentLinks=[].concat(e);if(d.currentPath=a,d.links=e,!(d.links.length>0))throw DD.Error.handle("notexist1",DD.words.route,a);return b&&(d.currentState={path:a,index:d.history++,forward:!0},history.pushState(d.currentState,"",DD.Router.root+a)),setTimeout(function(){d.linkLoad()},0),!0},initView:function(a){a.$isRouterView=!0,DD.attr(a,"role","route")}},window.addEventListener("popstate",function(a){var b=DD.Router;if(b.donop)return void(b.donop=!1);var c=history.state;if(c){var d=b.currentState&&c.index<b.currentState.index?!1:!0;b.start(c.path)?(b.currentState=c,b.currentState.forward=d):(b.donop=!0,d?history.go(-1):history.go(1))}});var a=function(a){var b=this;if(DD.isEmpty(a)||!DD.isObject(a))throw DD.Error.handle("invoke","route",0,"object");if(DD.isEmpty(a.module)&&!a.module instanceof DD.module)throw DD.Error.handle("invoke2","route","module",DD.words.module,"string");DD.assign(b,a),b.module=a.module,b.routes=[],b.type="string";var c;if(-1!==(c=b.path.indexOf("/:"))){b.type="param";var d=b.path.split("/:");b.path=d[0],b.paramNames=d.slice(1)}b.parent&&b.parent.routes.push(b),DD.Router.addRoute(b),a.routes&&a.routes.forEach(function(a){b.add(a)})};a.initView=function(a){var b=["path","activeclass","active","routeview"];a.$isRoute=!0;for(var c=!1,d=a.attributes.length-1;d>=0;d--){var e=a.attributes[d],f=e.name.toLowerCase();-1!==b.indexOf(f)&&(a.$routeConfig[f]=e.value,a.removeAttribute(e.name),"active"===f&&(c=!0))}if(c){DD.attr(a,"role","activeroute");var g=a.$routeConfig.activeclass;g&&DD.addClass(a,g)}var h=a.$routeConfig.path;"a"===a.tagName.toLowerCase()&&DD.attr(a,"href",h),new DD.Event({view:a,eventName:"click",handler:function(a,b,c){a.preventDefault();var d=DD.get("[role='activeroute']",!1,c.$module.view);if(null!==d){d.removeAttribute("role");var e=d.$routeConfig.activeclass;e&&DD.removeClass(d,e)}DD.attr(c,"role","activeroute"),e=c.$routeConfig.activeclass,e&&DD.addClass(c,e),DD.Router.start(h,!0)}})},a.prototype.start=function(a){function b(){var a;if(DD.isFunction(c.onEnter)&&c.onEnter.call(c.module),a=c.parent?c.parent.module.routerView:DD.App.routerView,!a)throw DD.Error.handle("notexist1",c.path,DD.words.routeView);if(d["switch"]&&"slide"===d["switch"].style){var b,e=a.children,f=DD.width(a,!0);e.length>0?b=e[0]:(DD.css(a,{overflowX:"hidden"}),b=DD.newEl("div"),DD.css(b,{boxSizing:"border-box",padding:0,margin:0,transition:"transform "+d["switch"].switchTime+" ease-out",transformStyle:"preserve-3d",overflowX:"hidden"}),b.addEventListener("transitionend",function(){if(b.children.length>1){var a=DD.Router.currentState&&!DD.Router.currentState.forward?!1:!0;a?(DD.remove(b.children[0]),DD.css(b,{transition:"",transform:"translate3d(0,0,0)"})):DD.remove(b.children[1]),DD.css(b,"width",""),d.switching=!1,setTimeout(function(){DD.css(b,"transition","transform "+d["switch"].switchTime+" ease-out")},50)}}),a.appendChild(b)),e=b.children;var g=DD.newEl("div");DD.css(g,{width:f+"px","float":"left"}),DD.merge(g,DD.extendElementConfig),g.$isView=!0;var h=DD.Router.currentState&&!DD.Router.currentState.forward?!1:!0;e.length>0?(d.switching=!0,DD.width(b,2*f),h?(b.appendChild(g),DD.css(b,"transform","translate3d(-"+f+"px,0,0)")):(b.insertBefore(g,e[0]),DD.css(b,{transition:"",transform:"translate3d(-"+f+"px,0,0)"}),setTimeout(function(){DD.css(b,{transition:"transform "+d["switch"].switchTime+" ease-out",transform:"translate3d(0,0,0)"})},50))):b.appendChild(g),c.module.view=g}else"fade"===d.switchStyle||(c.module.view=a,DD.empty(c.module.view));c.module.renderChildren=!0,DD.Renderer.add(c.module)}var c=this,d=DD.Router;if(d.current=c,c.data=c.newData,delete c.newData,DD.isString(c.module)&&(c.module=DD.Module.get(c.module),void 0===c.module))throw DD.Error.handle("notexist1",DD.words.module,c.module);c.module.inited?(c.module.data||(c.module.data=new DD.Model({data:{},module:c.module})),c.module.data.$set("$route",{path:a,data:c.data}),b()):c.module.init(function(){c.module.data||(c.module.data=new DD.Model({data:{},module:c.module})),c.module.data.$set("$route",{path:a,data:c.data}),b()})},a.prototype.add=function(b){var c=this;b.parent=c;var d=b;return b instanceof DD.Route||(d=new a(b)),d},DD.Route=a,DD.createRoute=function(a){if(DD.isArray(a))a.forEach(function(a){new DD.Route(a)});else if(DD.isObject(a))return new DD.Route(a)},DD.Directive.create({name:"route",preOrder:5,init:function(a){a&&(a=a.trim(),DD.isEmpty(a)||a&&"{{"===a.substr(0,2)&&"}}"===a.substr(a.length-2,2)||(DD.attr(this,"path",a),DD.Route.initView(this)))},handler:function(){var a=this;if("activeroute"===a.getAttribute("role")){var b=a.$routeConfig.path;if(a.$routeConfig.routeview){var c=DD.Router.getRouteLink(b);if(c.length>0){var d=c[c.length-1];d.routeView=a}}setTimeout(function(){DD.Router.start(b,!0)},0)}}}),DD.Directive.create({name:"router",preOrder:5,init:function(a){DD.Router.initView(this),this.$isRouterView=!0}})}(),DD.extendElementConfig={$module:null,$containModule:null,$isRouterView:!1,$directives:[],$savedDoms:{},$model:{},$attrs:{},$exprs:[],$isView:!0,$events:{},$routeConfig:{},$find:function(a,b){return b?this.querySelectorAll(a):this.querySelector(a)},$hasDirective:function(a){var b=this,c=b.$directives;if(DD.isArray(c))for(var d=0;d<c.length;d++)if(c[d].name===a)return!0;return!1},$getDirective:function(a){var b=this,c=b.$directives;if(DD.isArray(c))for(var d=0;d<c.length;d++)if(c[d].name===a)return c[d];return null},$removeDirective:function(a){var b=this,c=b.$directives;if(DD.isArray(c))for(var d=0;d<c.length;d++)if(c[d].name===a){c.splice(d);break}},$getData:function(){var a=this;if(!a.$isView)return null;var b,c,d,e;if(a.$model&&a.$model.data)e=a.$model.data,b=a.$model.aliasName,d=a.$model.index;else if(a.$module&&a.$module.data){for(var f=a;f&&f.$isView&&f!==a.$module.view;f=f.parentNode)if(f.$model&&f.$model.data){d=f.$model.index,e=f.$model.data,b=f.$model.aliasName,c=f.$model.indexName;break}a.$modelStr&&(e?DD.isObject(e)&&(DD.isEmpty(a.$modelStr)||(e=e.$get(a.$modelStr))):e=a.$module.data.$get(a.$modelStr)),e||(e=a.$module.data)}return{data:e,aliasName:b,indexName:c,index:d}}},function(){function a(){DD.Renderer.render(),setTimeout(a,0)}var b=function(){var a=this;a.waitList=[],a.rendering=!1,a.currentModule=null};b.prototype={add:function(a){var b=this;if(-1===b.waitList.indexOf(a)){if(void 0===a.prio)for(var c=1,d=a.parent;void 0!==d;)c++,d=d.parent;a.prio=c,b.waitList.push(a),b.waitList.sort(function(a,b){return a.prio-b.prio})}},remove:function(a){var b;-1!==(b=me.waitList.indexOf(a))&&me.waitList.splice(b,1)},render:function(){var a=this;if(0!==a.waitList.length)for(var b=0;b<a.waitList.length;b++){var c=a.waitList[b];a.currentModule=c,c.render()&&a.waitList.splice(b--,1)}}},DD.Renderer=new b,a()}(),DD.words={system:"系统",module:"模块",moduleClass:"模块类",model:"模型",directive:"指令",expression:"表达式",event:"事件",method:"方法",filter:"过滤器",data:"数据",dataItem:"数据项",route:"路由",routeView:"路由容器"},DD.ErrorMsgs={unknown:"未知错误",paramException:"{0} {1}方法参数错误，请参考api",invoke:"{0}方法调用参数{1}必须为{2}",invoke1:"{0}方法调用参数{1}必须为{2}或{3}",invoke2:"{0}方法调用参数{1}或{2}必须为{3}",invoke3:"{0}方法调用参数{1}不能为空",exist:"{0}已存在",exist1:"{0} {1}已存在",notexist:"{0}不存在",notexist1:"{0} {1}不存在",notupd:"{0}不可修改",notremove:"{0}不可删除",notremove1:"{0}{1}不可删除"},DD.FormMsgs={type:"请输入有效的{0}",unknown:"输入错误",required:"不能为空",min:"最小输入值为{0}",max:"最大输入值为{0}"};